<!DOCTYPE html>
<html>
<head>
<style>
.yellow {color:yellow;}
.white {color:white;}
.blend {background-color:black;color:white;border-color:black;}
body {height:100vh; margin: 0; background-color:black; position: relative;}
#gameContainer {width: 1050px; position: absolute; bottom: 5px; left: 400px; display: flex; flex-direction: column; box-sizing: border-box;}
#textBox {border: solid white; border-width: 12px; background-color: black; height: 225px; width: 1050px; margin: 15px auto; color: white; font-size: 24px; padding: 20px; box-sizing: border-box;}
#enemyContainer {height: 450px; width: 600px; margin: 0px auto 15px auto; border-width: 12px; background-image: url('grid.png'); background-position: center; background-repeat: no-repeat; box-sizing: border-box; display: flex; justify-content: center; align-items: center;}
#battleBox {border: solid white; border-width: 12px; height: 300px; width: 600px; background-color: black; margin: 0px auto 15px auto; visibility: hidden; position: relative;}
#menuBox {width: 1050px; height: 75px; margin: 10px auto 15px auto; display: flex; justify-content: space-around;}
</style>
</head>
<body style="background-color:black; position: relative;">
<div id="gameContainer">
<div id="enemyContainer">
<img id="enemy" src="froggit.gif" style="width: 116px; height: 111px;">
</div>
<div id="battleBox" style="visibility: hidden;">
</div>
<img src="soul-01.png" width="32" height="32" id="myPlayer01" style="position: absolute; left: 284px; top: 134px; opacity: 1.0;">
<div id="textBox">
</div>
<div id="menuBox">
<img id="fightBtn" src="fight.png" height="84" width="220">
<img id="actBtn" src="act.png" height="84" width="220">
<img id="itemBtn" src="item.png" height="84" width="220">
<img id="mercyBtn" src="mercy.png" height="84" width="220">
</div>
</div>
<script>
let enemyContainer = document.getElementById('enemyContainer');
let textBox = document.getElementById('textBox');
let battleBox = document.getElementById('battleBox');
let menuBox = document.getElementById('menuBox');
let playerElement = document.getElementById('myPlayer01');
let enemy = document.getElementById('enemy');
let maxHoriz = parseInt(battleBox.style.width) - 32;
let maxVerti = parseInt(battleBox.style.height) - 32;
let wMenuKeyDebounced = false;
let aMenuKeyDebounced = false;
let sMenuKeyDebounced = false;
let dMenuKeyDebounced = false;
let isMenuPhase = true;
let isActMenuPhase = false;
let isTargettingAct = false;
let isMercyChoice = false;
let isActionActive = false;
let myHoriz;
let myVerti;
let up = false;
let down = false;
let right = false;
let left = false;
let currentActItem = 1;
let currentMenuItem = 1;
let currentMercyItem = 1;
let actionKeyPressed = false;
let playerHealth = 20;
let enemyATK = 10;
let enemyDEF = 10;
let enemyMercy = 0;
let isInvincible = false;
let battleInitiated = false;
function writeText(dialogue, index = 0) {
if (index === 0) {textBox.innerHTML = '';}
if (index >= dialogue.length) {
return; 
}
let delay = 50;
if (dialogue.substring(index, index + 4) === '<br>') {
textBox.innerHTML += '<br>';
index += 4;
delay = 0;
} else {
textBox.innerHTML += dialogue[index];
index += 1;
}
setTimeout(function() {
writeText(dialogue, index);
}, delay);
}
function startBattle() {
battleBox.style.visibility = 'visible';
myVerti = 608;
myHoriz = 513;
writeText("*A Froggit appears!");
setInterval(movement, 10);
}
document.onkeydown = function(event){
if (event.key === "w"){
up = true;
if (isActMenuPhase){
if (!wMenuKeyDebounced){
if (currentActItem === 3 || currentActItem === 4){
currentActItem -= 2
updateActMenu();
}
}
wMenuKeyDebounced = true;
}
else if (isTargettingAct) {
if (!wMenuKeyDebounced) {
if (currentTargetItem === 3 || currentTargetItem === 4) {
currentTargetItem -= 2
updateActTarget();
}
}
wMenuKeyDebounced = true;
}
}
if (event.key === "s"){
down = true;
if (isActMenuPhase){
if (!sMenuKeyDebounced){
if (currentActItem === 1 || currentActItem === 2){
currentActItem += 2
updateActMenu();
}
}
sMenuKeyDebounced = true;
}
else if (isTargettingAct){
if (!sMenuKeyDebounced){
if (currentTargetItem === 1 || currentTargetItem === 2){
currentTargetItem += 2
updateActTarget();
}
}
sMenuKeyDebounced = true;
}
}
if (event.key === "a"){
left = true;
if (isMenuPhase){
if (!aMenuKeyDebounced){
currentMenuItem -= 1;
if (currentMenuItem < 1){ currentMenuItem = 4};
updateMenu();
}
aMenuKeyDebounced = true;
}
else if (isActMenuPhase){
if (!aMenuKeyDebounced){
if (currentActItem === 2 || currentActItem === 4) {
currentActItem -= 1;
updateActMenu();
}
}
aMenuKeyDebounced = true;
}
else if (isTargettingAct){
if (!isMenuPhase) {
if (!aMenuKeyDebounced){
if (currentTargetItem === 2 || currentTargetItem === 4) {
currentTargetItem -= 1;
updateActTarget();
}
}
aMenuKeyDebounced = true;
}
}
else if (isMercyChoice){
if (!isMenuPhase) {
if (!aMenuKeyDebounced){
if (currentMercyItem === 1){
currentMercyItem = 2;
updateMercySubmenu();
}
else if (currentMercyItem === 2){
currentMercyItem = 1;
updateMercySubmenu();
}
}
}
}
}
}
if (event.key === "d"){
right = true;
if (isMenuPhase){
if (!dMenuKeyDebounced){
currentMenuItem += 1;
if (currentMenuItem > 4){ currentMenuItem = 1};
updateMenu();
}
dMenuKeyDebounced = true;
}
else if (isActMenuPhase){
if (!dMenuKeyDebounced){
if (currentActItem === 1 || currentActItem === 3) {
currentActItem += 1;
updateActMenu();
}
}
dMenuKeyDebounced = true;
}
else if (isTargettingAct){
if (!dMenuKeyDebounced) {
if (currentTargetItem === 1 || currentTargetItem === 3) {
currentTargetItem += 1;
updateActTarget();
}
}
dMenuKeyDebounced = true;
}
else if (isMercyChoice) {
if (!isMenuPhase){
if (!dMenuKeyDebounced){
if (currentMercyItem === 1) {
currentMercyItem = 2;
updateMercySubmenu();
}
else if (currentMercyItem === 2) {
currentMercyItem = 1;
updateMercySubmenu();
}
}
}
}
}
if (event.key === "z" || event.key === "Enter" ){actionKeyPressed = true;}
if (event.key === "x" || event.key === "Shift" ){handleCancel();}
document.onkeyup = function(event){
if (event.key === "w"){up = false; wMenuKeyDebounced = false;}
if (event.key === "s"){down = false; sMenuKeyDebounced = false;}
if (event.key === "a"){left = false; aMenuKeyDebounced = false;}
if (event.key === "d"){right = false; dMenuKeyDebounced = false;}
if (event.key === "z" || event.key === "Enter" ){actionKeyPressed = false;}
}
function handleAction(){
if (actionKeyPressed) {
if (isMenuPhase) {
if (currentMenuItem === 1) {
actionKeyPressed = false
startAttackBar()
}
else if (currentMenuItem === 2) {
actionKeyPressed = false
startTargettingAct()
isTargettingAct = true;
isMenuPhase = false;
}
else if (currentMenuItem === 3) {
actionKeyPressed = false
startItemMenu()
}
else if (currentMenuItem === 4) {
actionKeyPressed = false
startMercyChoice()
isMenuPhase = false;
isMercyChoice = true;
}
}
else if (isTargettingAct) {
actionKeyPressed = false;
startActMenu();
isActMenuPhase = true;
isTargettingAct = false;
}
else if (isActMenuPhase) {
actionKeyPressed = false;
isActMenuPhase = false;
executeAct();
}
else if (isMercyChoice) {
actionKeyPressed = false;
isMercyChoice = false;
executeMercy();
}
}
function movement(){
if (!isMenuPhase && !isActMenuPhase && !isTargettingAct){
if (up) { myVerti -= 3}
if (down) { myVerti += 3}
if (left) { myHoriz -= 3}
if (right) { myHoriz += 3}
if (myHoriz < 0){myHoriz = 0}
if (myHoriz > maxHoriz){myHoriz = maxHoriz}
if (myVerti < 0){myVerti = 0}
if (myVerti > maxVerti){myVerti = maxVerti}
playerElement.style.top = myVerti + 'px'
playerElement.style.left = myHoriz + 'px'
} else {
handleAction();
}
}
function updateMenu(){
if (currentMenuItem === 1) {
playerElement.style.top = 1100 + 'px'
playerElement.style.left = 36 + 'px'
fightBtn.src = 'fightSelected.png'
actBtn.src = 'act.png'
itemBtn.src = 'item.png'
mercyBtn.src = 'mercy.png'
}
else if (currentMenuItem === 2) {
playerElement.style.top = 1100 + 'px'
playerElement.style.left = 300 + 'px'
fightBtn.src = 'fight.png'
actBtn.src = 'actSelected.png'
itemBtn.src = 'item.png'
mercyBtn.src = 'mercy.png'
}
else if (currentMenuItem === 3) {
playerElement.style.top = 1100 + 'px'
playerElement.style.left = 561 + 'px'
fightBtn.src = 'fight.png'
actBtn.src = 'act.png'
itemBtn.src = 'itemSelected.png'
mercyBtn.src = 'mercy.png'
}
else if (currentMenuItem === 4) {
playerElement.style.top = 1100 + 'px'
playerElement.style.left = 825 + 'px'
fightBtn.src = 'fight.png'
actBtn.src = 'act.png'
itemBtn.src = 'item.png'
mercyBtn.src = 'mercySelected.png'
}
}

function handleCancel() {
if (!isActionActive) {
if (isActMenuPhase) {
isMenuPhase = false;
isActMenuPhase = false;
isTargettingAct = true;
startTargettingAct();
}
else if (isTargettingAct) {
isTargettingAct = false;
isMenuPhase = true;
updateMenu();
writeText("*A Froggit appears!");
}
else if (!isMenuPhase && !isActMenuPhase && !isTargettingAct) {
isMenuPhase = true;
updateMenu();
if (enemyMercy === 100) {
writeText("*Froggit seems very reluctant to fight.")
}
else
{
writeText("*Froggit awaits your next move!")
}
}
}
}
function startAttackBar() {}
function startActMenu() {
updateActMenu()
}
function startItemMenu() {}
function startMercySubmenu() {
updateMercySubmenu();
}
function updateMercySubmenu
textBox.innerHTML = `
<table style="width: 100%; height: 100%; table-layout: fixed; text-align: center;">
<tr style="height: 50%;">
<td class="${currentMercyChoice === 1 ? 'yellow' : 'white'}">* Spare</td>
<td class="${currentMercyChoice === 2 ? 'yellow' : 'white'}">* Flee</td>
</tr>
</table>
`;
if (currentMercyChoice === 1){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 220 + 'px'
}
if (currentMercyChoice === 2){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 700 + 'px'
}
function executeMercy() {
if (currentMercyChoice === 1){
if (enemyMercy === 100) {
writeText ("*You spared the enemy!<br>*You won!")
setTimeout(() => {location = 'undertale-test-05.html';}, 7000)
}
else {
writeText ("*You spared the enemy!<br>*But it's name wasn't YELLOW...")
setTimeout(() => {handleCancel();}, 7000)
}
}
else if (currentMercyChoice === 2){
writeText ("*Escaping...");
setTimeout(() => {location = 'undertale-test-05.html';}, 4)
}
}
function executeAct() {
if (currentActItem === 1) {
writeText (`*FROGGIT - ${enemyATK} ATK ${enemyDEF} DEF <br>*It looks like it can learn a lot from this world.`);
isActMenuPhase = false;
isTargettingAct = false;
isMenuPhase = false;
isActionActive = true;
setTimeout(() => {enemyAttack();}, 7000)
}
else if (currentActItem === 2) {
writeText ("*You complimented Froggit.<br>*It didn't understand a word you said, but was flattered anyway.");
isActMenuPhase = false;
isTargettingAct = false;
isMenuPhase = false;
isActionActive = true;
enemyMercy = 100;
setTimeout(() => {enemyAttack();}, 7000)
}
else if (currentActItem === 3) {
writeText ("*You threatened Froggit.<br>*It doesn't have the faintest clue of what you just said, but your tone was intimidating.<br>*Froggits DEFENSE decreased!");
isActMenuPhase = false;
isTargettingAct = false;
isMenuPhase = false;
isActionActive = true;
enemyDEF -= 3;
setTimeout(() => {enemyAttack();}, 12000)
}
else if (currentActItem === 4) {
writeText ("*You did nothing.<br>*Froggit was confused, but decided to attack anyway.")
isActMenuPhase = false;
isTargettingAct = false;
isMenuPhase = false;
isActionActive = true;
setTimeout(() => {enemyAttack();}, 7000)
}
}
function enemyAttack() {
writeText ("*Froggit prepares an attack. (this is a placeholder)")
isActionActive = false;
setTimeout(() => {handleCancel();}, 5000)
}
function startTargettingAct() {
currentTargetItem = 1;
updateActTarget();
}
function updateActTarget() {
textBox.innerHTML = `
<table style="width: 100%; height: 100%; table-layout: fixed; text-align: center;">
<tr style="height: 50%;">
<td class="${currentTargetItem === 1 ? 'yellow' : 'white'}">* Froggit</td>
<td class="${currentTargetItem === 2 ? 'yellow' : 'white'}"></td>
</tr>
<tr style="height: 50%;">
<td class="${currentTargetItem === 3 ? 'yellow' : 'white'}"></td>
<td class="${currentTargetItem === 4 ? 'yellow' : 'white'}"></td>
</tr>
</table>
`;
if (currentTargetItem === 1){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 220 + 'px'
}
if (currentTargetItem === 2){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 700 + 'px'
}
if (currentTargetItem === 3){
playerElement.style.top = 955 + 'px'
playerElement.style.left = 220 + 'px'
}
if (currentTargetItem === 4){
playerElement.style.top = 955 + 'px'
playerElement.style.left = 700 + 'px'
}
}
function updateActMenu() {
textBox.innerHTML = `
<table style="width: 100%; height: 100%; table-layout: fixed; text-align: center;">
<tr style="height: 50%;">
<td class="${currentActItem === 1 ? 'yellow' : 'white'}">* Check</td>
<td class="${currentActItem === 2 ? 'yellow' : 'white'}">* Compliment</td>
</tr>
<tr style="height: 50%;">
<td class="${currentActItem === 3 ? 'yellow' : 'white'}">* Threaten</td>
<td class="${currentActItem === 4 ? 'yellow' : 'white'}">* Do nothing</td>
</tr>
</table>
`;
if (currentActItem === 1){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 220 + 'px'
}
if (currentActItem === 2){
playerElement.style.top = 875 + 'px'
playerElement.style.left = 700 + 'px'
}
if (currentActItem === 3){
playerElement.style.top = 955 + 'px'
playerElement.style.left = 220 + 'px'
}
if (currentActItem === 4){
playerElement.style.top = 955 + 'px'
playerElement.style.left = 700 + 'px'
}
}
updateMenu();
startBattle();
</script>
</body>
</html>
